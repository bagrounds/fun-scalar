{
  "image": "node:4",
  "cache": {
    "untracked": true,
    "key": "$CI_COMMIT_REF_NAME",
    "paths": [
      "node_modules/"
    ]
  },
  "stages": [
    "setup",
    "test",
    "deploy"
  ],
  "setup": {
    "stage": "setup",
    "script": [
      "npm install"
    ]
  },
  "test": {
    "stage": "test",
    "script": [
      "npm test"
    ],
    "except": [
      "pages"
    ]
  },
  "lint": {
    "stage": "test",
    "script": [
      "npm run lint"
    ],
    "except": [
      "pages"
    ]
  },
  "publish": {
    "stage": "deploy",
    "script": [
      "./script/update.js"
    ],
    "environment": "npm",
    "only": [
      "master"
    ]
  },
  "pages": {
    "stage": "deploy",
    "script": [
      "npm run pages"
    ],
    "environment": "pages",
    "artifacts": {
      "paths": [
        "public"
      ]
    },
    "only": [
      "master"
    ]
  }
}
